<svg xmlns="http://www.w3.org/2000/svg" width="920" height="420" viewBox="0 0 920 420"><rect width="100%" height="100%" fill="#fff"/><defs><style>.t{font:14px sans-serif;fill:#0b2540}.l{stroke:#0b2540;stroke-width:2;marker-end:url(#a)}</style><marker id="a" markerWidth="10" markerHeight="10" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 z" fill="#0b2540"/></marker></defs><text class="t" x="60" y="60">Device → Broker: TLS (CA pinning) + user/pass</text><line class="l" x1="60" y1="70" x2="860" y2="70"/><text class="t" x="60" y="140">Backend → Broker: TLS + user/pass</text><line class="l" x1="60" y1="150" x2="860" y2="150"/><text class="t" x="60" y="220">Browser → Nginx: HTTPS</text><line class="l" x1="60" y1="230" x2="860" y2="230"/><text class="t" x="60" y="300">Browser → Backend: JWT (Bearer) and WS `?token=`</text><line class="l" x1="60" y1="310" x2="860" y2="310"/></svg>